CREATE OR REPLACE PACKAGE BODY Consultas AS 
	PROCEDURE pedirConsultaCab(fecha date, dniPa varchar2(9))
 	IS 
 		dniCab varchar2(8);
 		nuevoID int;
	BEGIN 
		SELECT DNIempleado INTO dniCab FROM HistorialAsigna WHERE DNIpaciente = dniPa ;
		SELECT IDconsulta INTO nuevoID FROM ConsultaPideRealiza WHERE IDconsulta >= ANY ( SELECT IDconsulta FROM ConsultaPideRealiza );
		nuevoID := nuevoID + 1 ;
		INSERT INTO ConsultaPideRealiza VALUES ( nuevoID, fecha, dniPa, dniCab ); 
   	END pedirConsultaCab; 

	PROCEDURE cancelarConsulta( idcon int )
 	IS 
	BEGIN 
		DELETE FROM ConsultaPideRealiza WHERE IDconsulta = idcon; 
   	END cancelarConsulta; 
   
	PROCEDURE confirmacion ( idcon int )
	IS 
	BEGIN 
		UPDATE ConsultaPideRealiza SET Valida = 'true' WHERE IDconsulta = idcon;
	END confirmacion; 

	PROCEDURE derivarEsp ( fecha date, dniPa varchar2(9), dniEs varchar2(9) )
	IS
		nuevoID int;
	BEGIN 
		SELECT IDconsulta INTO nuevoID FROM ConsultaPideRealiza WHERE IDconsulta >= ANY ( SELECT IDconsulta FROM ConsultaPideRealiza );
		nuevoID := nuevoID + 1 ;
		INSERT INTO ConsultaPideRealiza VALUES ( nuevoID, fecha, dniPa, dniEs ); 
	END derivarEsp; 

END Consultas;
